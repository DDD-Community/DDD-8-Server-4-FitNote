{% extends 'base.html' %}
{% block content %}
<div class="card">
  <h5 class="card-header">회원가입</h5>
  <div class="card-body">
    <h5 class="card-title">Special title treatment</h5>
    <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>

        <div class="input-group mb-3">
            <span class="input-group-text" id="inputGroup-sizing-default">email</span>
            <input type="text" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default" id="singup_email" placeholder="email">
        </div>

        <div class="input-group mb-3">
            <span class="input-group-text" id="inputGroup-sizing-default">user_name</span>
            <input type="text" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default" id="singup_user_name" placeholder="user_name">
        </div>

        <div class="input-group mb-3">
            <span class="input-group-text" id="inputGroup-sizing-default">password1</span>
            <input type="text" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default" id="singup_password1" placeholder="password1">
        </div>

        <div class="input-group mb-3">
            <span class="input-group-text" id="inputGroup-sizing-default">password2</span>
            <input type="text" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default" id="singup_password2" placeholder="password2">
        </div>

        <div class="d-flex flex-row-reverse">
          <button class="btn btn-primary" id="request_account_singup">회원가입</button>
        </div>
        
        <p id="result_account_singup"></p>

  </div>
</div>

<script>

  document.getElementById("request_account_singup").addEventListener("click", () => {

      // GET TYPE START
      var email = document.getElementById("singup_email").value;
      var user_name = document.getElementById("singup_user_name").value;
      var password1 = document.getElementById("singup_password1").value;
      var password2 = document.getElementById("singup_password2").value;

      let xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = (e) => {
          let req = e.target;
          if (req.readyState === XMLHttpRequest.DONE) {
              if (req.status === 201) {
                  document.getElementById("result_account_singup").innerHTML = "통신성공 : "+req.responseText;
              }
          }

      }

      xhttp.open("POST", "{% url 'rest_register' %}", true);
      xhttp.setRequestHeader('X-CSRFToken', '{{csrf_token}}');
      xhttp.setRequestHeader('Content-Type', 'application/json;charset=utf-8');
      xhttp.send("{\"email\":\""+email+"\",\"user_name\":\""+user_name+"\",\"password1\":\""+password1+"\",\"password2\":\""+password2+"\"}");

  });

</script> 



{% endblock %}

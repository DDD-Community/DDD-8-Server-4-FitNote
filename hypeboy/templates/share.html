{% load static %}

<!doctype html>
<html lang="ko">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
  <meta name="generator" content="Hugo 0.108.0">

  <title>FitNote - share</title>

  <link rel="canonical" href="https://getbootstrap.com/docs/5.3/examples/sign-in/">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>

  <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="{% static 'css/sign-in.css' %}" rel="stylesheet" />

</head>

<body class="text-center">

  <main class="form-signin w-100 m-auto fixed-top mt-5">
    <div class="mb-3">수업 공유하기</div>

    <div class="card bg-body-tertiary">
      <div class="card-body d-flex flex-column align-items-start">
        <div class="card-title" style="font-size: 14px;">{{year}}년 {{month}}월 {{date}}일</div>
        <div class="card-subtitle mb-n2 text-muted" style="font-size: 12px;">{{user_name}} 회원님</div>
      </div>
    </div>

    <div class="mt-3 mb-2">

      <div class="d-flex flex-column align-items-start mt-1">

        {% for res in result %}
          <div style="font-size: 14px;">{{ res.name }}</div>
          <canvas class="w-100" id="myChart{{ forloop.counter0 }}" style="margin-top: -30%;"></canvas>
        {% endfor %}
        
        <script type="text/javascript">
          window.onload = function() {
            {% for res in result %}
              var chartData{{ forloop.counter0 }} = [
                {% for data in res.list %}
                  {
                    set: {{ data.set }},
                    count: {{ data.count }},
                    weight: {{ data.weight|floatformat:1 }}
                  }{% if not forloop.last %},{% endif %}
                {% endfor %}
              ];
              drawChart({{ forloop.counter0 }}, chartData{{ forloop.counter0 }});
            {% endfor %}
          };
        </script>
        

      </div>

    </div>

    <div class="d-flex justify-content-between mt-3 mb-3 text-muted">
      <div><a style="font-size: 12px;">체계적인 PT 관리, 핏노트</a></div>
      <div><a style="font-size: 12px;">트레이너 {{trainer_name}}</a></div>
    </div>

    <!-- <input type='text' id='input_text' style='position:absolute; left:-9999px' value="http://www.fitnote.co.kr/hypeboy/share/3/20230211"> -->

    <!-- <button class="w-100 btn btn-lg btn-primary" style="font-size: 12px;" type="button" id="btnShare">공유하기</button> -->

    <div class="fixed-bottom mb-5">&copy; FitNote</div>
  </main>

</body>

<script src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/feather.min.js" integrity="sha384-uO3SXW5IuS1ZpFPKugNNWqTZRRglnUJK6UAZ/gxOX80nxEkN9NcGZTftn6RzhGWE" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.0.0/dist/chart.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>

<!-- <script src="{% static 'css/dashboard.js' %}"></script> -->

<script type="text/javascript">

  function drawChart(resultCount, chartData) {

    const ctx = document.getElementById('myChart'+resultCount)

    // 카운트 
    const labels = ['', '', '', '', '', '', ]
    const data = [];

    for (let i = 0; i < chartData.length; i++) {
      const { set, count, weight } = chartData[i];
      data.push(weight);
      labels[i] = count + '회';
    }

    // eslint-disable-next-line no-unused-vars
    const myChart = new Chart(ctx, {
      type: 'line',
      plugins: [ChartDataLabels],
      data: {
        labels: labels,
        datasets: [{
          data: data,
          lineTension: 0,
          backgroundColor: 'transparent',
          borderColor: '#007bff',
          borderWidth: 4,
          pointBackgroundColor: '#007bff',
        }]
      },
      options: {
        plugins: {
          legend: { // 범례 사용 안 함
            display: false,
          },
          tooltip: { // 기존 툴팁 사용 안 함
            enabled: false
          },
          animation: { // 차트 애니메이션 사용 안 함 (옵션)
            duration: 0,
          },
          datalabels: {
            align: 'top',
            offset: 8,
            font: { // font 설정
              size: '14px',
            },
            color: '#222', // font color
          },
        },

        scales: {
          x: {
            grid: {
              display: false,
            }
          },
          y: {
            display: false,
            beginAtZero: true,
            min: 0,
            max: 499, // max 값 조정
            ticks: { // y축 줄당 표시 값
              stepSize: 1
            }
          },
        },

      }
    })
  }

</script>

</html>
